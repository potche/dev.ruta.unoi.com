{% extends '::base.html.twig' %}
{% block body %}

    <div id="page-content">

        <div class="content-header">
            <div class="header-section">
                <h1>
                    <i class="fa fa-line-chart"></i><b>{{ title }}</b><br><small><em>Evaluaciones</em></small>
                </h1>
            </div>
        </div>

        <div id="block-resumen" class="block">
            <div class="block-title">
                <div class="block-options pull-right">
                    <a href="javascript:void(0)" class="btn btn-info btn-sm btn-primary" data-toggle="block-toggle-content"><i class="fa fa-arrows-v"></i></a>
                </div>
                <h2><strong>Graficas</strong></h2>
                {% if schoolId is defined %}
                <form id="schoolFrm" action="{{ path('estadisticas')}}" method="GET">
                    <select id="schoolId" name="schoolId" class="form-control" size="1">
                        <option value="0">Por favor seleccione una escuela</option>
                        {% for school in schoolId %}
                            <li>
                                <option value='{{ school.schoolid|e }}' >{{ school.schoolid|e }} - {{ school.school|e }}</option>
                            </li>
                        {% endfor %}
                    </select>
                </form>
                {% endif %}
            </div>

            <div class="row">
                <div class="block-content">
                    <div class="col-sm-6">

                        <div id="pie" class="block">
                            <div id="container" style="height: 400px"></div>
                        </div>

                    </div>
                </div>
                <div class="block-content">
                    <div class="col-sm-6">
                        <div id="bars" class="block">
                            <div id="containerColumn" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>


    <script src="{{ asset('public/assets/js/Highcharts/highcharts.js')}}"></script>
    <script src="{{ asset('public/assets/js/Highcharts/highcharts-3d.js')}}"></script>
    <script src="{{ asset('public/assets/js/Highcharts/modules/exporting.js')}}"></script>
    <script src="{{ asset('public/assets/js/Highcharts/modules/drilldown.js')}}"></script>

    <script type="text/javascript">

        $(function () {
            var chart = new Highcharts.Chart
            ({
                chart: {
                    type: 'pie',
                    renderTo: 'container',
                    options3d: {
                        enabled: true,
                        alpha: 45,
                        beta: 0
                    }
                },
                title: {
                    text: 'Estadistica General'
                },
                subtitle: {
                    text: 'En porcentaje.'
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        depth: 35,
                        dataLabels: {
                            enabled: true,
                            format: '{point.name}'
                        }
                    }
                },
                series: [{
                    type: 'pie',
                    name: 'Respuesta',
                    data: {{ jsonTotalResponsePie | raw }}
                }]
            });
        });

        //---------------------------------------------
        $(function () {
            // Create the chart
            var chartColoumn = new Highcharts.Chart({
                chart: {
                    type: 'column',
                    renderTo: 'containerColumn'
                },
                title: {
                    text: 'Estadistica General'
                },
                subtitle: {
                    text: 'Cantidad de Respuestas.'
                },
                xAxis: {
                    type: 'category'
                },
                yAxis: {
                    title: {
                        text: 'Total percent market share'
                    }

                },
                legend: {
                    enabled: false
                },
                plotOptions: {
                    series: {
                        borderWidth: 0,
                        dataLabels: {
                            enabled: true,
                            format: '{point.y}'
                        }
                    }
                },

                tooltip: {
                    headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
                    pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y}</b><br/>'
                },

                series: [{
                    name: 'Respuesta',
                    colorByPoint: true,
                    data: {{ jsonTotalResponseColumn | raw }}
                }],
                drilldown: {
                    series: [{{ jsonTotalResponseDDColumn | raw }}]
                }
            });
        });


        $( "#schoolId" ).change(function() {
            $("#schoolFrm").submit();
        });

    </script>
{% endblock %}